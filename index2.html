<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–æ–≤—ã–π HTML –≤–∏–¥–∂–µ—Ç –¥–ª—è —Ç–∞–±–ª–æ 240x60px</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            font-family: Tahoma, sans-serif;
            font-weight: normal;
            overflow: hidden;
            width: 240px;
            height: 60px;
        }
        
        .bus-container {
            width: 240px;
            height: 60px;
            background-color: #000;
            display: flex;
            flex-direction: column;
            position: relative;
            margin: 0;
            padding: 0;
        }
        
        .bus-row {
            display: flex;
            align-items: center;
            padding: 0;
            margin: 0;
            height: 20px;
            font-size: 20px;
            font-weight: normal;
            color: #ff0000;
            position: relative;
        }
        
        .route {
            position: absolute;
            left: 0;
            font-weight: normal;
            color: #ff0000;
            text-align: left;
            font-size: 20px;
            font-family: Tahoma, sans-serif;
        }
        
        .destination {
            position: absolute;
            left: 40px;
            font-size: 20px;
            font-weight: normal;
            color: #ff0000;
            white-space: nowrap;
            overflow: visible;
            font-family: Tahoma, sans-serif;
            width: 160px;
        }
        
        .time {
            position: absolute;
            right: 0;
            font-weight: normal;
            color: #ff0000;
            text-align: right;
            font-size: 20px;
            font-family: Tahoma, sans-serif;
        }
        
        .no-buses {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #ff0000;
            font-size: 20px;
            font-weight: normal;
            text-align: center;
            font-family: Tahoma, sans-serif;
        }
        
        .update-indicator {
            position: absolute;
            top: 1px;
            right: 2px;
            width: 4px;
            height: 4px;
            background: #ff0000;
            border-radius: 50%;
            animation: blink 2s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="bus-container">
        <div class="update-indicator"></div>
        
        <div id="bus-data">
            <!-- –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–±—É—Å–æ–≤ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
            <div class="bus-row fade-in">
                <div class="route">7A</div>
                <div class="destination">–ê–í–¢–û–í–û–ö–ó–ê–õ –®–´–ú–ë–ê–ô</div>
                <div class="time">10</div>
            </div>
            <div class="bus-row fade-in">
                <div class="route">7A</div>
                <div class="destination">–¢–û–†–ì–û–í–´–ô –ö–û–ú–ü–õ–ï–ö–°_A</div>
                <div class="time">23</div>
            </div>
            <div class="bus-row fade-in">
                <div class="route">12</div>
                <div class="destination">–¶–ï–ù–¢–†</div>
                <div class="time">5</div>
            </div>
        </div>
    </div>

    <script>
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞)
        const testBusData = [
            { route: "7A", destination: "–ê–í–¢–û–í–û–ö–ó–ê–õ –®–´–ú–ë–ê–ô", time: "10" },
            { route: "7A", destination: "–¢–û–†–ì–û–í–´–ô –ö–û–ú–ü–õ–ï–ö–°_A", time: "23" },
            { route: "12", destination: "–¶–ï–ù–¢–†", time: "5" }
        ];

        function updateBusData(busData) {
            const container = document.getElementById('bus-data');
            
            if (!busData || busData.length === 0) {
                container.innerHTML = '<div class="no-buses">–ù–ï–¢ –ê–í–¢–û–ë–£–°–û–í</div>';
                return;
            }
            
            container.innerHTML = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–∞–∫—Å–∏–º—É–º 3 –∞–≤—Ç–æ–±—É—Å–∞ –¥–ª—è —Ä–∞–∑–º–µ—Ä–∞ 240x60
            const displayData = busData.slice(0, 3);
            
            displayData.forEach((bus, index) => {
                const row = document.createElement('div');
                row.className = 'bus-row fade-in';
                row.style.animationDelay = `${index * 0.1}s`;
                
                // –°–æ–∫—Ä–∞—â–∞–µ–º –¥–ª–∏–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
                let destination = bus.destination;
                if (destination.length > 15) {
                    destination = destination.substring(0, 12) + '..';
                }
                
                row.innerHTML = `
                    <div class="route">${bus.route}</div>
                    <div class="destination">${destination}</div>
                    <div class="time">${bus.time}</div>
                `;
                
                container.appendChild(row);
            });
        }

        function formatTimeDisplay(minutes) {
            if (minutes <= 0) return '–°–ï–ô–ß–ê–°';
            if (minutes === 1) return '1';
            return `${minutes}`;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        function simulateDataUpdate() {
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏–±—ã—Ç–∏—è
            const updatedData = testBusData.map(bus => ({
                ...bus,
                time: formatTimeDisplay(Math.floor(Math.random() * 30) + 1)
            }));
            
            updateBusData(updatedData);
            console.log('üîÑ –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:', new Date().toLocaleTimeString());
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateBusData(testBusData);
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        setInterval(simulateDataUpdate, 5000);
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
        async function fetchRealBusData() {
            try {
                // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ URL –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
                const response = await fetch('/api/bus-data');
                const data = await response.json();
                updateBusData(data);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
                // Fallback –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
                updateBusData(testBusData);
            }
        }
        
        console.log('üöå HTML –≤–∏–¥–∂–µ—Ç —Ç–∞–±–ª–æ –∑–∞–≥—Ä—É–∂–µ–Ω');
        console.log('üìê –†–∞–∑–º–µ—Ä: 240x60 –ø–∏–∫—Å–µ–ª–µ–π');
        console.log('üîÑ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥');
    </script>
</body>
</html>
